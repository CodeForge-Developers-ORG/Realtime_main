{"version":3,"sources":["turbopack:///[project]/src/services/productService.ts","turbopack:///[project]/src/components/products/CatalogClient.tsx","turbopack:///[project]/src/components/products/Card.tsx","turbopack:///[project]/src/components/products/SectionList.tsx","turbopack:///[project]/src/components/products/Sidebar.tsx"],"sourcesContent":["import axiosClient from \"./axiosClient\";\r\n\r\nexport const getProducts = async (pageNum: number) => {\r\n  const response = await axiosClient.get(`/content/products?page=${pageNum}`);\r\n  return response.data;\r\n};\r\nexport const getProductsWithoutPagination = async () => {\r\n  const response = await axiosClient.get(`/content/products`);\r\n  return response.data;\r\n};\r\n\r\nexport const getProductBySlug = async (slug: string) => {\r\n  const response = await axiosClient.get(`/content/products?slug=${slug}`);\r\n  return response.data;\r\n};\r\n","\"use client\";\r\n\r\nimport { useEffect, useState, useRef } from \"react\";\r\nimport SectionList from \"./SectionList\";\r\nimport Sidebar from \"./Sidebar\";\r\nimport { getProducts } from \"@/services/productService\";\r\n\r\nexport type Product = {\r\n  slug: string;\r\n  id: string;\r\n  title: string;\r\n  description: string;\r\n  category: { name: string; slug: string };\r\n  images: string[];\r\n};\r\n\r\nexport type Category = {\r\n  title: string;\r\n  items: { id: string; name: string; image: string; slug: string }[];\r\n};\r\n\r\nexport default function CatalogClient() {\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [activeIndex, setActiveIndex] = useState(0);\r\n  const [page, setPage] = useState(1);\r\n  const [hasMore, setHasMore] = useState(true);\r\n  const [loading, setLoading] = useState(true);\r\n  const loaderRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  // Load products (paginated)\r\n  const loadProducts = async (pageNum: number) => {\r\n    try {\r\n      setLoading(true);\r\n      const res = await getProducts(pageNum);\r\n      // const json = await res.json();\r\n      if (res?.data?.length) {\r\n        setProducts((prev) => {\r\n          const merged = [...prev, ...res.data];\r\n          return Array.from(new Map(merged.map((p) => [p.id, p])).values());\r\n        });\r\n        setHasMore(res.meta.current_page < res.meta.last_page);\r\n      } else {\r\n        setHasMore(false);\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadProducts(page);\r\n  }, [page]);\r\n\r\n  // Infinite scroll\r\n  useEffect(() => {\r\n    if (!loaderRef.current) return;\r\n    const observer = new IntersectionObserver(\r\n      (entries) => {\r\n        const first = entries[0];\r\n        if (first.isIntersecting && hasMore && !loading) {\r\n          setPage((prev) => prev + 1);\r\n        }\r\n      },\r\n      { threshold: 1 }\r\n    );\r\n\r\n    observer.observe(loaderRef.current);\r\n    return () => observer.disconnect();\r\n  }, [hasMore, loading]);\r\n\r\n  // Group products by category for Sidebar + SectionList\r\n  const groupedCategories: Category[] = Object.values(\r\n    products.reduce((acc, p) => {\r\n      const catName = p.category?.name || \"Uncategorized\";\r\n      if (!acc[catName]) acc[catName] = { title: catName, items: [] };\r\n      acc[catName].items.push({\r\n        id: p.id,\r\n        name: p.title,\r\n        image: p.images?.[0] || \"/no-image.jpg\",\r\n        slug: p?.slug || \"\",\r\n      });\r\n      return acc;\r\n    }, {} as Record<string, Category>)\r\n  );\r\n\r\n  const isLastActive = activeIndex === groupedCategories.length - 1;\r\n\r\n  return (\r\n    <div\r\n      className={`flex gap-6 bg-white p-4 md:p-8 lg:p-[100px] transition-all duration-300 ${\r\n        isLastActive ? \"sticky\" : \"sticky -top-20\"\r\n      }`}>\r\n      {/* Sidebar */}\r\n      <aside className=\"w-64 hidden lg:block\">\r\n        <Sidebar\r\n          categories={groupedCategories}\r\n          activeIndex={activeIndex}\r\n          onSelect={setActiveIndex}\r\n        />\r\n      </aside>\r\n\r\n      {/* SectionList */}\r\n      <section className=\"flex-1\">\r\n        <SectionList\r\n          categories={groupedCategories}\r\n          activeIndex={activeIndex}\r\n          onActiveChange={setActiveIndex}\r\n        />\r\n\r\n        {/* Loader for infinite scroll */}\r\n        {loading && <div className=\"text-center py-4\">Loading more...</div>}\r\n        <div ref={loaderRef} className=\"h-10\" />\r\n      </section>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { baseUri } from \"@/services/constant\";\r\n\r\ntype Product = {\r\n  image?: string | null;\r\n  name?: string | null;\r\n};\r\n\r\ninterface CardProps {\r\n  it?: Product;\r\n}\r\n\r\nconst Card: React.FC<CardProps> = ({ it }) => {\r\n  return (\r\n    <div className=\"bg-gray-50 rounded-xl p-4 shadow-sm cursor-pointer hover:shadow-md transition\">\r\n      <div className=\"bg-white rounded-lg p-0 flex items-center justify-center h-40\">\r\n        <img\r\n          src={`${baseUri}${it?.image ?? \"\"}`}\r\n          alt={it?.name ?? \"\"}\r\n          className=\"max-h-full object-contain\"\r\n        />\r\n      </div>\r\n      <div className=\"mt-3 text-black text-center font-medium\">{it?.name}</div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Card;\r\n","\"use client\";\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport type { Category } from \"./CatalogClient\";\r\nimport Card from \"./Card\";\r\nimport Link from \"next/link\";\r\n\r\nexport default function SectionList({\r\n  categories,\r\n  activeIndex,\r\n  onActiveChange,\r\n}: {\r\n  categories: Category[];\r\n  activeIndex: number;\r\n  onActiveChange: (i: number) => void;\r\n}) {\r\n  const containerRef = useRef<HTMLDivElement | null>(null);\r\n  const sectionRefs = useRef<Record<number, HTMLDivElement | null>>({});\r\n\r\n  // Listen to sidebar click custom event\r\n  useEffect(() => {\r\n    const handler = (e: Event) => {\r\n      const detail = (e as CustomEvent).detail;\r\n      const idx = detail?.index;\r\n      if (typeof idx === \"number\") {\r\n        const el = sectionRefs.current[idx];\r\n        if (el && containerRef.current) {\r\n          const topOffset =\r\n            el.getBoundingClientRect().top +\r\n            window.scrollY -\r\n            (containerRef.current.offsetTop ?? 0) -\r\n            8; // small padding\r\n          window.scrollTo({ top: topOffset, behavior: \"smooth\" });\r\n        }\r\n      }\r\n    };\r\n    window.addEventListener(\"scroll-to-section\", handler as EventListener);\r\n    return () =>\r\n      window.removeEventListener(\"scroll-to-section\", handler as EventListener);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const observer = new IntersectionObserver(\r\n      (entries) => {\r\n        entries.forEach((entry) => {\r\n          if (entry.isIntersecting) {\r\n            const id = entry.target.getAttribute(\"data-idx\");\r\n            if (id) onActiveChange(Number(id));\r\n          }\r\n        });\r\n      },\r\n      {\r\n        root: null, // observe relative to viewport\r\n        threshold: [0.15, 0.5, 0.9],\r\n      }\r\n    );\r\n\r\n    categories.forEach((_, i) => {\r\n      const el = sectionRefs.current[i];\r\n      if (el) observer.observe(el);\r\n    });\r\n\r\n    return () => observer.disconnect();\r\n  }, [categories, onActiveChange]);\r\n\r\n  return (\r\n    <div ref={containerRef} className=\"pr-4\">\r\n      {categories.map((cat, i) => (\r\n        <div\r\n          key={cat.title}\r\n          data-idx={i}\r\n          ref={(el) => {\r\n            sectionRefs.current[i] = el;\r\n          }}\r\n          className=\"mb-10 p-4 rounded-lg border border-gray-200 bg-white\">\r\n          <h3 className=\"text-2xl text-black font-medium mb-4\">{cat.title}</h3>\r\n          <div className=\"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 gap-6\">\r\n            {cat.items.map((it) => (\r\n              // eslint-disable-next-line react/jsx-key\r\n              <Link key={it.id} href={`/products/${it?.slug}`}>\r\n                <Card it={it} />\r\n              </Link>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport type { Category } from \"./CatalogClient\";\r\n\r\nexport default function Sidebar({\r\n  categories,\r\n  activeIndex,\r\n  onSelect,\r\n}: {\r\n  categories: Category[];\r\n  activeIndex: number;\r\n  onSelect: (i: number) => void;\r\n}) {\r\n  const btnRefs = useRef<Record<number, HTMLButtonElement | null>>({});\r\n\r\n  // Keep active button visible relative to viewport (parent scroll)\r\n  useEffect(() => {\r\n    const activeBtn = btnRefs.current[activeIndex];\r\n    if (activeBtn) {\r\n      const rect = activeBtn.getBoundingClientRect();\r\n      const offsetTop = rect.top + window.scrollY;\r\n      const offsetBottom = rect.bottom + window.scrollY;\r\n      const viewTop = window.scrollY;\r\n      const viewBottom = viewTop + window.innerHeight;\r\n\r\n      if (offsetTop < viewTop || offsetBottom > viewBottom) {\r\n        // Scroll window so button is visible\r\n        window.scrollTo({\r\n          top: offsetTop - 20, // 20px padding from top\r\n          behavior: \"smooth\",\r\n        });\r\n      }\r\n    }\r\n  }, [activeIndex]);\r\n\r\n  return (\r\n    <div className=\"sticky top-5\">\r\n      <div className=\"space-y-3\">\r\n        {categories.map((c, i) => (\r\n          <button\r\n            key={c.title}\r\n            ref={(el) => { btnRefs.current[i] = el; }}\r\n            className={`block w-full text-[16px] text-left px-4 py-3 rounded-lg transition-shadow hover:shadow-md ${\r\n              activeIndex === i\r\n                ? \"bg-[#EFAF00] text-[#1E1410] font-[300]\"\r\n                : \"bg-[#F6F6F6] text-[#1E1410] font-[300] cursor-pointer\"\r\n            }`}\r\n            onClick={() => {\r\n              window.dispatchEvent(\r\n                new CustomEvent(\"scroll-to-section\", { detail: { index: i } })\r\n              );\r\n              onSelect(i);\r\n            }}\r\n          >\r\n            {c.title}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"uGAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAEO,IAAM,EAAc,MAAO,GAEzB,CADU,MAAM,EAAA,OAAW,CAAC,GAAG,CAAC,CAAC,uBAAuB,EAAE,EAAA,EAAS,EAC1D,IAAI,CAET,EAA+B,SAEnC,CADU,MAAM,EAAA,OAAW,CAAC,GAAG,CAAC,CAAC,iBAAiB,EAAC,EAC1C,IAAI,uECNtB,EAAA,EAAA,CAAA,CAAA,OCCA,EAAA,EAAA,CAAA,CAAA,aAWkC,CAAC,IAAE,CAAE,CAAE,GAErC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,GAaM,OAbI,0FACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yEACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,IAAK,CAAA,EAAG,EAAA,OAAO,CAAA,EAAG,GAAI,OAAS,GAAA,CAAI,CACnC,IAAK,GAAI,MAAQ,GACjB,UAAU,gCAGd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mDAA2C,GAAI,UCpBpE,IAAA,EAAA,EAAA,CAAA,CAAA,OAEe,SAAS,EAAY,YAClC,CAAU,aACV,CAAW,gBACX,CAAc,CAKf,EACC,IAAM,EAAe,CAAA,EAAA,EAAA,MAAA,AAAM,EAAwB,MAC7C,EAAc,CAAA,EAAA,EAAA,MAAM,AAAN,EAA8C,CAAC,GAgDnE,MA7CA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAU,AAAC,IACf,IAAM,EAAU,EAAkB,MAAM,CAClC,EAAM,GAAQ,MACpB,GAAmB,UAAf,OAAO,EAAkB,CAC3B,IAAM,EAAK,EAAY,OAAO,CAAC,EAAI,CACnC,GAAI,GAAM,EAAa,OAAO,CAAE,CAC9B,IAAM,EACJ,EAAG,qBAAqB,GAAG,GAAG,CAC9B,OAAO,OAAO,EACb,CAAD,CAAc,OAAO,CAAC,SAAS,GAAI,CAAC,CACpC,EACF,CADK,MACE,QAAQ,CAAC,CAAE,AADG,IACE,EAAW,SAAU,QAAS,EACvD,CACF,CACF,EAEA,OADA,OAAO,gBAAgB,CAAC,oBAAqB,GACtC,IACL,OAAO,mBAAmB,CAAC,oBAAqB,EACpD,EAAG,EAAE,EAEL,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAW,IAAI,qBAClB,AAAD,IACE,EAAQ,OAAO,CAAC,AAAC,IACf,GAAI,EAAM,cAAc,CAAE,CACxB,IAAM,EAAK,EAAM,MAAM,CAAC,YAAY,CAAC,YACjC,GAAI,EAAe,OAAO,GAChC,CACF,EACF,EACA,CACE,KAAM,KACN,UAAW,CAAC,IAAM,GAAK,GAAI,AAC7B,GAQF,OALA,EAAW,OAAO,CAAC,CAAC,EAAG,KACrB,IAAM,EAAK,EAAY,OAAO,CAAC,EAAE,AAC7B,IAAI,EAAS,OAAO,CAAC,EAC3B,GAEO,IAAM,EAAS,UAAU,EAClC,EAAG,CAAC,EAAY,EAAe,EAG7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,IAAK,EAAc,UAAU,gBAC/B,EAAW,GAAG,CAAC,CAAC,EAAK,IACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,WAAU,EACV,IAAK,AAAC,IACJ,EAAY,OAAO,CAAC,EAAE,CAAG,CAC3B,EACA,UAAU,iEACV,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,gDAAwC,EAAI,KAAK,GAC/D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gEACZ,EAAI,KAAK,CAAC,GAAG,CAAC,AAAC,GAEd,CAAA,CADA,CACA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAa,KAAM,CAAC,UAAU,EAAE,GAAI,CADA,IACA,CAAM,UAC7C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAK,GAAI,KADD,EAAG,EAAE,OAVf,EAAI,KAAK,IAmBxB,CCnFe,SAAS,EAAQ,YAC9B,CAAU,aACV,CAAW,UACX,CAAQ,CAKT,EACC,IAAM,EAAU,CAAA,EAAA,EAAA,MAAA,AAAM,EAA2C,CAAC,GAsBlE,MAnBA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAY,EAAQ,OAAO,CAAC,EAAY,CAC9C,GAAI,EAAW,CACb,IAAM,EAAO,EAAU,qBAAqB,GACtC,EAAY,EAAK,GAAG,CAAG,OAAO,OAAO,CACrC,EAAe,EAAK,MAAM,CAAG,OAAO,OAAO,CAC3C,EAAU,OAAO,OAAO,CACxB,EAAa,EAAU,OAAO,WAAW,AAE3C,IAAY,GAAW,EAAe,CAAA,GAAY,AAEpD,OAAO,QAAQ,CAAC,CACd,IAAK,EAAY,GACjB,SAAU,QACZ,EAEJ,CACF,EAAG,CAAC,EAAY,EAGd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAW,GAAG,CAAC,CAAC,EAAG,IAClB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEC,IAAK,AAAC,IAAS,EAAQ,OAAO,CAAC,EAAE,CAAG,CAAI,EACxC,UAAW,CAAC,0FAA0F,EACpG,IAAgB,EACZ,yCACA,wDAAA,CACJ,CACF,QAAS,KACP,OAAO,aAAa,CAClB,IAAI,YAAY,oBAAqB,CAAE,OAAQ,CAAE,MAAO,CAAE,CAAE,IAE9D,EAAS,EACX,WAEC,EAAE,KAAK,EAdH,EAAE,KAAK,MAoBxB,CHvDA,IAAA,EAAA,EAAA,CAAA,CAAA,OAgBe,SAAS,IACtB,GAAM,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EAChD,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACzC,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GAC3B,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GACjC,EAAY,CAAA,EAAA,EAAA,MAAA,AAAM,EAAwB,MAG1C,EAAe,MAAO,IAC1B,GAAI,CACF,GAAW,GACX,IAAM,EAAM,MAAM,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,GAE1B,GAAK,MAAM,QAAQ,AACrB,EAAY,AAAC,IACX,IAAM,EAAS,IAAI,KAAS,EAAI,IAAI,CAAC,CACrC,OAAO,MAAM,IAAI,CAAC,IAAI,IAAI,EAAO,GAAG,CAAC,AAAC,GAAM,CAAC,EAAE,EAAE,CAAE,EAAE,GAAG,MAAM,GAChE,GACA,EAAW,EAAI,IAAI,CAAC,YAAY,CAAG,EAAI,IAAI,CAAC,SAAS,GAErD,GAAW,EAEf,CAAE,MAAO,EAAK,CACZ,QAAQ,KAAK,CAAC,EAChB,QAAU,CACR,GAAW,EACb,CACF,EAEA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,EAAa,EACf,EAAG,CAAC,EAAK,EAGT,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GAAI,CAAC,EAAU,OAAO,CAAE,OACxB,IAAM,EAAW,IAAI,qBACnB,AAAC,IACe,AACV,CADiB,CAAC,EAAE,CACd,cAAc,EAAI,GAAW,CAAC,GACtC,EAAQ,AAAC,GAAS,CAD6B,CACtB,EAE7B,EACA,CAAE,UAAW,CAAE,GAIjB,OADA,EAAS,OAAO,CAAC,EAAU,OAAO,EAC3B,IAAM,EAAS,UAAU,EAClC,EAAG,CAAC,EAAS,EAAQ,EAGrB,IAAM,EAAgC,OAAO,MAAM,CACjD,EAAS,MAAM,CAAC,CAAC,EAAK,KACpB,IAAM,EAAU,EAAE,QAAQ,EAAE,MAAQ,gBAQpC,OAPI,AAAC,CAAG,CAAC,EAAQ,GAAE,CAAG,CAAC,EAAQ,CAAG,CAAE,MAAO,EAAS,MAAO,EAAE,CAAC,EAC9D,CAAG,CAAC,EAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,CACtB,GAAI,EAAE,EAAE,CACR,KAAM,EAAE,KAAK,CACb,MAAO,EAAE,MAAM,EAAE,CAAC,EAAE,EAAI,gBACxB,KAAM,GAAG,MAAQ,EACnB,GACO,CACT,EAAG,CAAC,IAGA,EAAe,IAAgB,EAAkB,MAAM,CAAG,EAEhE,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAW,CAAC,wEAAwE,EAClF,EAAe,SAAW,iBAAA,CAC1B,WAEF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,gCACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACC,WAAY,EACZ,YAAa,EACb,SAAU,MAKd,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAU,mBACjB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACC,WAAY,EACZ,YAAa,EACb,eAAgB,IAIjB,GAAW,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,4BAAmB,oBAC9C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,IAAK,EAAW,UAAU,cAIvC"}